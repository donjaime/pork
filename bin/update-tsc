#!/usr/bin/env python2.7

import os
import shutil
import subprocess

def Main():
  root = os.path.abspath(
    os.path.join(
      os.path.dirname(__file__),
      os.path.pardir))
  deps = os.path.join(root, 'deps')
  tsc = os.path.join(deps, 'tsc')

  if os.path.exists(tsc):
    shutil.rmtree(tsc)

  subprocess.call(
    ['git', 'clone', 'https://git01.codeplex.com/typescript', 'tsc'],
    cwd = deps)

  shutil.rmtree(os.path.join(tsc, '.git'))

  # for some reason the binary is not even executable. maybe they
  # work on windows!?
  os.chmod(os.path.join(tsc, 'bin/tsc'), 0755)

if __name__ == '__main__':
  Main()